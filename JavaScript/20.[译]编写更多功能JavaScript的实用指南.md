## [译] 编写更多功能 JavaScript 的实用指南

> - 原文地址：[A practical guide to writing more functional JavaScript](https://medium.freecodecamp.org/a-practical-guide-to-writing-more-functional-javascript-db49409f71)
> - 原文作者：Nadeesha Cabral
> - 本文永久链接：
> - 译者：heyushuo

功能编程很棒。随着 React 的引入，越来越多的 JavaScript 前端代码正在考虑 FP 原则。但是我们如何在我们编写的日常代码中开始使用 FP 思维模式？我将尝试使用日常代码块并逐步重构它。

**我们的问题：**用户来到我们/登录页面链接后会带一个`redirect_to` 参数。就像`/login？redirect_to =％2Fmy-page`。请注意，当`％2Fmy-page` 被编码为 `URL` 的一部分时，它实际上是`/ my-page`。我们需要提取此查询参数，并将其存储在本地存储中，以便在完成登录后，可以将用户重定向到 `my-page`页面。

## 第一步：必要的方法

如果我们必须以发布命令列表的最简单形式表达解决方案，我们将如何编写它？我们需要

1. 解析链接后参数。
2. 获取 redirect_to 值。
3. 解码该值。
4. 将解码后的值存储在 localStorage 中。

我们还必须将 try catch 块放在“不安全”函数周围。有了这些，我们的代码块将如下所示：

```javascript
function persistRedirectToParam() {
  let parsedQueryParam;
  try {
    //获取连接后的参数{redirect_to:'/my-page'}
    parsedQueryParam = qs.parse(window.location.search); // https://www.npmjs.com/package/qs
  } catch (e) {
    console.log(e);
    return null;
  }
  //获取到参数
  const redirectToParam = parsedQueryParam.redirect_to;
  if (redirectToParam) {
    const decodedPath = decodeURIComponent(redirectToParam);
    try {
      localStorage.setItem('REDIRECT_TO', decodedPath);
    } catch (e) {
      console.log(e);
      return null;
    }
    //返回  my-page
    return decodedPath;
  }
  return null;
}
```
